<!DOCTYPE html>
<html>
<head>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <title>Dashboard | sync.js</title>
  <link rel="icon" href="icon.png" />
<style>
body {margin: 0;}

ul.topnav {
  list-style-type: none;
  margin: 0;
  padding: 0;
  overflow: hidden;
  background-color: whitesmoke;
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
  text-align: center;
  display: flex;
  justify-content: center;
}

ul.topnav li {float: left;}

ul.topnav li a {
  display: block;
  color: white;
  text-align: center;
  padding: 14px 16px;
  text-decoration: none;
}

ul.topnav li a:hover:not(.active) {background-color: #d9d9d9;}

ul.topnav li a.active {background-color: #1a73e8;}

ul.topnav li.right {float: right;}

@media screen and (max-width: 600px) {
  ul.topnav li.right, 
  ul.topnav li {float: none;}
}

  .msoBig {
    font-size: 35px;
  }
</style>
</head>
<body>

<ul class="topnav">
  <li><a class="active" href="#" id="home" onclick="tabChange(this)"><span class="material-symbols-outlined msoBig" title="Account">account_circle</span></a></li>
  <li><a href="#" id="data" onclick="tabChange(this)"><span class="material-symbols-outlined msoBig" title="My Data">folder_open</span></a></li>
  <li><a href="#" id="setup" onclick="tabChange(this)"><span class="material-symbols-outlined msoBig" title="Bookmarklets">bookmark</span></a></li>
</ul>

<div style="padding:0 16px;">
  <div id="homeC" style="text-align:center"></div>
  <div id="dataC" style="display:none">Loading...</div>
  <div id="setupC" style="display:none">
    <p>Drag this link into your bookmarks bar:</p>
    <a href='javascript:void(var sjsInjection = document.createElement("div"); sjsInjection.innerHTML = atob("PGRpdiBzdHlsZT0icG9zaXRpb246IGFic29sdXRlO3JpZ2h0OjUwcHg7Ym90dG9tOjUwcHg7Ij48aW1nIHNyYz0iaHR0cHM6Ly9zeW5jLWpzLnBhZ2VzLmRldi9pY29uLnBuZyIgd2lkdGg9IjIwIiBzdHlsZT0iYm9yZGVyOiA1cHggc29saWQgcmdiYSgwLCAwLCAwLCAwLjQ1KTtib3JkZXItcmFkaXVzOjIwcHg7Y3Vyc29yOnBvaW50ZXI7IiBvbmNsaWNrPSJzanNTZXRNb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJyIgdGl0bGU9InN5bmMuanMiIC8+PC9kaXY+CiAgICAgIDxkaXYgc3R5bGU9ImRpc3BsYXk6IG5vbmU7IC8qIEhpZGRlbiBieSBkZWZhdWx0ICovIHBvc2l0aW9uOiBmaXhlZDsgLyogU3RheSBpbiBwbGFjZSAqLyB6LWluZGV4OiAxOyAvKiBTaXQgb24gdG9wICovIGxlZnQ6IDA7IHRvcDogMDsgd2lkdGg6IDEwMCU7IC8qIEZ1bGwgd2lkdGggKi8gaGVpZ2h0OiAxMDAlOyAvKiBGdWxsIGhlaWdodCAqLyBvdmVyZmxvdzogYXV0bzsgLyogRW5hYmxlIHNjcm9sbCBpZiBuZWVkZWQgKi8gYmFja2dyb3VuZC1jb2xvcjogcmdiKDAsMCwwKTsgLyogRmFsbGJhY2sgY29sb3IgKi8gYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLDAsMCwwLjQpOyAvKiBCbGFjayB3LyBvcGFjaXR5ICovIiBpZD0ic2pzU2V0TW9kYWwiPjxkaXYgc3R5bGU9Im1hcmdpbjogMTUlIGF1dG87IGJhY2tncm91bmQ6IHdoaXRlOyBib3gtc2hhZG93OiAwIDRweCA4cHggMCByZ2JhKDAsIDAsIDAsIDAuMiksIDAgNnB4IDIwcHggMCByZ2JhKDAsIDAsIDAsIDAuMTkpOyB0ZXh0LWFsaWduOiBjZW50ZXI7IGJveC1zaXppbmc6IGJvcmRlci1ib3g7IGJvcmRlci1yYWRpdXM6IDEwcHg7IHdpZHRoOiA1MCU7IGJvcmRlcjogMnB4IHNvbGlkIGJsdWU7cGFkZGluZzogMjBweDsiPgogICAgICAgIDxzcGFuIHN0eWxlPSJjb2xvcjogcmVkOyBmbG9hdDogcmlnaHQ7IGZvbnQtc2l6ZTogMjhweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGN1cnNvcjpwb2ludGVyOyIgb25jbGljaz0ic2pzU2V0TW9kYWwuc3R5bGUuZGlzcGxheSA9ICdub25lJyI+JnRpbWVzOzwvc3Bhbj4KICAgICAgICA8YnV0dG9uIG9uY2xpY2s9J3dpbmRvdy5vcGVuKCJodHRwczovL3N5bmMtanMucGFnZXMuZGV2L2JhY2t1cD9mcm9tVVJMPSIgKyBidG9hKGxvY2F0aW9uLmhyZWYpICsgIiZkYXRhPSIgKyBidG9hKEpTT04uc3RyaW5naWZ5KGxvY2FsU3RvcmFnZSkpLnJlcGxhY2VBbGwoIisiLCIlMkIiKSwiIiwid2lkdGg9NTAwLGhlaWdodD05MDAiKScgc3R5bGU9InRyYW5zaXRpb246IGVhc2UgMTUwbXM7IGJhY2tncm91bmQ6ICM0NmIwNjM7IGJvcmRlcjogbm9uZTsgYm9yZGVyLXJhZGl1czogM3B4OyB3aWR0aDogNTAwcHg7IGhlaWdodDogNTBweDsiPkJhY2sgVXA8L2J1dHRvbj4KICAgICAgICA8cD48L3A+CiAgICAgICAgPGJ1dHRvbiBvbmNsaWNrPSd2YXIgc2pzd2luMTIzID0gd2luZG93Lm9wZW4oImh0dHBzOi8vc3luYy1qcy5wYWdlcy5kZXYvZ2V0P3VybD0iICsgYnRvYShsb2NhdGlvbi5ocmVmKSwiIiwid2lkdGg9NTAwLGhlaWdodD05MDAiKTsgdmFyIHNqc3RpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7IGlmKHNqc3dpbjEyMy5jbG9zZWQpIHsgY2xlYXJJbnRlcnZhbChzanN0aW1lcik7IHZhciBzanNTWVNqc29uID0gSlNPTi5wYXJzZShwcm9tcHQoIlBhc3RlIERhdGE6IikpO09iamVjdC5rZXlzKHNqc1NZU2pzb24pLmZvckVhY2goZnVuY3Rpb24gKGspIHtsb2NhbFN0b3JhZ2Uuc2V0SXRlbShrLHNqc1NZU2pzb25ba10pfSkgfSB9LCAxMDAwKScgc3R5bGU9InRyYW5zaXRpb246IGVhc2UgMTUwbXM7IGJhY2tncm91bmQ6ICM0NmIwNjM7IGJvcmRlcjogbm9uZTsgYm9yZGVyLXJhZGl1czogM3B4OyB3aWR0aDogNTAwcHg7IGhlaWdodDogNTBweDsiPlJlc3RvcmU8L2J1dHRvbj4KICAgICAgPC9kaXY+CiAgICAgIDwvZGl2Pg=="); document.body.appendChild(sjsInjection))'>Start sync.js</a>
  </div>
</div>
<script>
var currentTab = "home";
function tabChange(tab) {
  tab.classList = "active";
  var tabid = tab.id
  document.getElementById(tabid + "C").style.display = "block";
  if (currentTab != tabid) {
  document.getElementById(currentTab + "C").style.display = "none";
  document.getElementById(currentTab).classList = "";
  }
  currentTab = tabid
}

function changeSite(site) {
  var siteid = site.id;
  if (site.innerHTML.includes("arrow_drop_down")) {
    site.innerHTML = site.innerHTML.replace("arrow_drop_down","arrow_drop_up")
    document.getElementById(siteid + "C").style.display = "block";
    site.classList = "dropdownli dropdownliFocus";
  } else if (site.innerHTML.includes("arrow_drop_up")) {
    site.innerHTML = site.innerHTML.replace("arrow_drop_up","arrow_drop_down");
    document.getElementById(siteid + "C").style.display = "none";
    site.classList = "dropdownli";
  }
}
</script>
  <script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getDatabase, ref, set, get, child } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional

  const firebaseConfig = {

    apiKey: "AIzaSyDWGbCICgDCm6XLz6gvuxnZTbsxACm-Fx4",

    authDomain: "sync-js-6aa9d.firebaseapp.com",

    projectId: "sync-js-6aa9d",

    storageBucket: "sync-js-6aa9d.appspot.com",

    messagingSenderId: "856081502457",

    appId: "1:856081502457:web:8579832305cceae2e89228"

  }; 
  const app = initializeApp(firebaseConfig);
  const auth = getAuth();
  const dbRef = ref(getDatabase());

  function decodeFB(text2) {
     var text1 = text2.replaceAll("%2E",".").replaceAll("%23","#").replaceAll("%24","$").replaceAll("%2F","/").replaceAll("%5B","[").replaceAll("%5D","]").replaceAll('%22','"').replaceAll("%3A",":")
     return text1;
   }  
    
  function listSites(jarray) {
    var toadd = "<p></p>";
    Object.keys(jarray).forEach(function (k) {
      var toadd2 = "";
      var arrTemp = jarray[k];
      console.log(arrTemp)
      Object.keys(arrTemp).forEach(function (k2) {
        toadd2 = toadd2 + "<p>" + decodeFB(k2) + ": " + arrTemp[k2] + "</p>"
      });
      toadd = toadd + "<a class='dropdownli' onclick='changeSite(this)' id='" + decodeFB(k) + "'>" + decodeFB(k) + " <span class='material-symbols-outlined'>arrow_drop_down</span></a><div style='display:none;padding:0 50px;' id='" + decodeFB(k) + "C'>" + toadd2 + "</div><br>";
    })
    return toadd;
  }
    window.listSites = listSites
    
onAuthStateChanged(auth, (user) => {
  if (user) {
    homeC.innerHTML = "<p></p><img src='icon.png' /><h1>Welcome, " + user.email + "</h1><button onclick='userLogout()'><span class='material-symbols-outlined'>logout</span></button><p>Select a tab above to get started.</p>";
    get(child(dbRef, "users/" + user.uid)).then((snapshot) => {
      if (snapshot.exists()) {
        dataC.innerHTML = listSites(snapshot.val());
        window.lstestarr = snapshot.val();
      } else {
        dataC.innerHTML = "<h1 style='text-align:center'>No Data Yet!</h1>"
      }
    });
  } else {
    location.replace("login")
  }
});
    function userLogout() {
      signOut(auth).then(() => {
        location.replace("/")
      }).catch((error) => {
        alert(error)
      });
    }
    window.userLogout = userLogout;
  </script>
</body>
</html>
